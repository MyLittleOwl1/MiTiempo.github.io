<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Meteo AEMET Móvil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app">
    <header>
      <div class="app-title">
        <span>Meteo AEMET</span>
        <span class="badge">By Gaby</span>
      </div>
      <p class="subtitle">
        Datos oficiales de AEMET: observación  y predicción horaria en Córdoba-Aeropuerto
      </p>
    </header>

    <!-- TIEMPO ACTUAL -->
    <section class="card" id="card-actual">
      <div class="card-header">
        <div class="card-title">
        </div>
        <div style="display:flex; align-items:center; gap:8px;">
          <div class="status-text" id="status-actual">Esperando datos…</div>
          <button id="btn-refresca" class="btn-refresh" title="Refrescar datos" aria-label="Refrescar datos">
            ↻
          </button>
        </div>
      </div>

      <!-- SELECT PROVINCIA / ESTACIÓN (responsive para móvil) -->
      <div class="controls" id="controls-estacion" aria-label="Selector de provincia y estación">
        <label class="control-label" for="provincia-select">
          Provincia
          <select id="provincia-select" class="mobile-select" aria-label="Provincia"></select>
        </label>
        <label class="control-label" for="estacion-select">
          Estación
          <select id="estacion-select" class="mobile-select" aria-label="Estación"></select>
        </label>
      </div>

      <div class="current-main">
        <div class="current-temp" id="temp-actual">
          --<span>°C</span>
        </div>
        <div class="current-extra">
          <span id="humedad-actual">Humedad: -- %</span>
          <span id="presion-actual">Presión: -- hPa</span>
          <span id="actualizado-actual">Actualizado: --</span>
        </div>
      </div>

      <div class="chips">
        <span class="chip" id="chip-estacion">ID estación: —</span>
        <span class="chip" id="chip-fecha">Sin fecha</span>
      </div>

      <p class="error hidden" id="error-actual"></p>
    </section>

    <!-- PREVISIÓN 24 HORAS -->
    <section class="card" id="card-forecast">
      <div class="card-header">
        <div class="card-title">
          <span>Previsión 24 h</span>
          <span class="pill" id="city-label">Municipio —</span>
        </div>
        <div class="status-text" id="status-forecast">Esperando datos…</div>
      </div>

      <div class="forecast-list" id="forecast-list">
        <!-- Tarjetas horarias generadas por JS -->
      </div>

      <p class="error hidden" id="error-forecast"></p>

      <div class="toolbar">
        <span id="last-update">—</span>

        <!-- NUEVO: selector de municipio y botón para consultar -->
        <label class="control-label" for="municipio-select" style="margin-left:8px;">
          Municipio
          <select id="municipio-select" class="mobile-select" aria-label="Municipio"></select>
        </label>
        <button id="btn-consulta-municipio" class="btn-refresh" title="Consultar municipio">
          Consultar
        </button>

        <button id="btn-refresh" class="btn-refresh">
          <span>Actualizar</span>
        </button>
      </div>
    </section>

    <!-- HISTÓRICO PRESIÓN 7 DÍAS -->
    <section class="card" id="card-presion">
      <div class="card-header">
        <div class="card-title">
          <span></span>
          <span class="pill" id="presion-label">Estación —</span>
          <span class="pill" id="presion-fecha">—</span>
        </div>
        <div class="status-text" id="status-presion">Esperando datos…</div>
      </div>

      <!-- tabla con título único en la primera fila -->
      <div style="overflow-x:auto; margin-top:4px;">
        <table style="width:100%; border-collapse:collapse; font-size:0.7rem;">
          <thead>
            <tr>
              <th colspan="4" style="text-align:center; padding:6px 2px; border-bottom:1px solid rgba(55,65,81,0.8); font-weight:700;font-size:1rem; color:var(--color-text);">
                Datos por horas
              </th>
            </tr>
            <tr style="color:#9ca3af;">
              <th style="text-align:left; padding:4px 2px; border-bottom:1px solid rgba(55,65,81,0.8);">
                Hora
              </th>
              <th style="text-align:right; padding:4px 2px; border-bottom:1px solid rgba(55,65,81,0.8);">
                Presión (hPa)
              </th>
              <th style="text-align:right; padding:4px 2px; border-bottom:1px solid rgba(55,65,81,0.8);">
                Temperatura (°C)
              </th>
              <th style="text-align:right; padding:4px 2px; border-bottom:1px solid rgba(55,65,81,0.8);">
                Humedad (%)
              </th>
            </tr>
          </thead>
          <tbody id="tabla-presion-cuerpo">
            <!-- Filas generadas por JS -->
          </tbody>
        </table>
      </div>

      <p class="error hidden" id="error-presion"></p>
    </section>

    <footer>
      Fuente: AEMET OpenData. Esta aplicación no es oficial.
    </footer>
  </div>
  <script src="script.js"></script>

</body>
</html>
